<div class="source" style="background: #ffffff"><pre style="line-height: 125%"><span></span><span style="font-weight: bold">from</span> <span style="color: #555555">pygments</span> <span style="font-weight: bold">import</span> highlight
<span style="font-weight: bold">from</span> <span style="color: #555555">pygments.formatters</span> <span style="font-weight: bold">import</span> HtmlFormatter
<span style="font-weight: bold">from</span> <span style="color: #555555">pygments.lexers</span> <span style="font-weight: bold">import</span> get_lexer_by_name
<span style="font-weight: bold">import</span> <span style="color: #555555">sys</span>

<span style="font-weight: bold">class</span> <span style="color: #445588; font-weight: bold">plain_text_to_formatted_text</span>:
    <span style="font-weight: bold">def</span> <span style="color: #990000; font-weight: bold">__init__</span>(<span style="color: #999999">self</span>,inpfil,outfil):
        <span style="color: #999999">self</span><span style="font-weight: bold">.</span>__inpfil<span style="font-weight: bold">=</span>inpfil    <span style="color: #999988; font-style: italic">#inpfil is a private data member ( __ before name specifies private)</span>
        <span style="color: #999999">self</span><span style="font-weight: bold">.</span>__outfil<span style="font-weight: bold">=</span>outfil    <span style="color: #999988; font-style: italic">#outfil is a private data member ( __ before name specifies private)</span>

    <span style="font-weight: bold">def</span> <span style="color: #990000; font-weight: bold">file_</span>(<span style="color: #999999">self</span>):
        
        <span style="font-weight: bold">try</span>:
            rf <span style="font-weight: bold">=</span> <span style="color: #999999">open</span>(<span style="color: #999999">self</span><span style="font-weight: bold">.</span>__inpfil,<span style="color: #bb8844">&#39;r&#39;</span>)
        <span style="font-weight: bold">except</span> <span style="color: #990000; font-weight: bold">IOError</span>:
            <span style="font-weight: bold">print</span>(f<span style="color: #bb8844">&quot;Couldn&#39;t read file {self.__inpfil}&quot;</span>)
            sys<span style="font-weight: bold">.</span>exit()

        <span style="font-weight: bold">with</span> rf:
            code <span style="font-weight: bold">=</span> rf<span style="font-weight: bold">.</span>read()
        rf<span style="font-weight: bold">.</span>close()
        <span style="font-weight: bold">return</span> code

    <span style="font-weight: bold">def</span> <span style="color: #990000; font-weight: bold">line_numbers</span>(<span style="color: #999999">self</span>):
        flag <span style="font-weight: bold">=</span> <span style="color: #999999">input</span>(<span style="color: #bb8844">&#39;\nPress\n-&gt;1 to insert line Numbers\n-&gt;Any other key for not : &#39;</span>)
        <span style="font-weight: bold">if</span> flag <span style="font-weight: bold">==</span> <span style="color: #bb8844">&#39;1&#39;</span>:
            <span style="font-weight: bold">return</span> <span style="color: #999999">True</span>
        <span style="font-weight: bold">else</span>:
            <span style="font-weight: bold">return</span> <span style="color: #999999">False</span>


    <span style="font-weight: bold">def</span> <span style="color: #990000; font-weight: bold">select_style</span>(<span style="color: #999999">self</span>):

        style_list<span style="font-weight: bold">=</span> [<span style="color: #bb8844">&#39;autumn&#39;</span>, <span style="color: #bb8844">&#39;borland&#39;</span>, <span style="color: #bb8844">&#39;bw&#39;</span>, <span style="color: #bb8844">&#39;colorful&#39;</span>, <span style="color: #bb8844">&#39;default&#39;</span>, <span style="color: #bb8844">&#39;emacs&#39;</span>,
                    <span style="color: #bb8844">&#39;fruity&#39;</span>, <span style="color: #bb8844">&#39;manni&#39;</span>, <span style="color: #bb8844">&#39;monokai&#39;</span>, <span style="color: #bb8844">&#39;murphy&#39;</span>, <span style="color: #bb8844">&#39;native&#39;</span>, <span style="color: #bb8844">&#39;pastie&#39;</span>,
                     <span style="color: #bb8844">&#39;rrt&#39;</span>, <span style="color: #bb8844">&#39;tango&#39;</span>, <span style="color: #bb8844">&#39;trac&#39;</span>, <span style="color: #bb8844">&#39;vim&#39;</span> ,<span style="color: #bb8844">&#39;friendly&#39;</span>, <span style="color: #bb8844">&#39;perldoc&#39;</span>]
        
        <span style="font-weight: bold">while</span> <span style="color: #999999">True</span>:
            styl <span style="font-weight: bold">=</span> <span style="color: #999999">input</span>(f<span style="color: #bb8844">&quot;\nSpecify a style from this list :\n{style_list}\n&quot;</span>)
            <span style="font-weight: bold">if</span> styl <span style="font-weight: bold">in</span> style_list:
                <span style="font-weight: bold">return</span> styl
            <span style="font-weight: bold">else</span>:
                <span style="font-weight: bold">print</span>(<span style="color: #bb8844">&#39;Please specify style from the given list only&#39;</span>)


    <span style="font-weight: bold">def</span> <span style="color: #990000; font-weight: bold">__conversion</span>(<span style="color: #999999">self</span>,code,var,styl):       <span style="color: #999988; font-style: italic"># This is a Private Method ( __ before method name)</span>
        lexer <span style="font-weight: bold">=</span> get_lexer_by_name(<span style="color: #bb8844">&quot;python&quot;</span>, stripall<span style="font-weight: bold">=</span><span style="color: #999999">True</span>)
        formatter <span style="font-weight: bold">=</span> HtmlFormatter(linenos <span style="font-weight: bold">=</span> var, cssclass <span style="font-weight: bold">=</span> <span style="color: #bb8844">&#39;source&#39;</span>, style<span style="font-weight: bold">=</span>styl)
        formatter<span style="font-weight: bold">.</span>noclasses <span style="font-weight: bold">=</span> <span style="color: #999999">True</span>
        <span style="font-weight: bold">with</span> <span style="color: #999999">open</span>(<span style="color: #bb8844">&quot;demo/&quot;</span><span style="font-weight: bold">+</span><span style="color: #999999">self</span><span style="font-weight: bold">.</span>__outfil, <span style="color: #bb8844">&quot;w&quot;</span>) <span style="font-weight: bold">as</span> f:
            result <span style="font-weight: bold">=</span> highlight(code, lexer, formatter, f)
        <span style="font-weight: bold">print</span>(f<span style="color: #bb8844">&quot;\nFormatted File is generated as- {self.__outfil}&quot;</span>)


<span style="font-weight: bold">def</span> <span style="color: #990000; font-weight: bold">main</span>():
    ch <span style="font-weight: bold">=</span> <span style="color: #999999">int</span>(<span style="color: #999999">input</span>(<span style="color: #bb8844">&#39;1.Demo(with default file)\n2.Convert\n3.Exit\n:&#39;</span>))
    <span style="font-weight: bold">if</span> ch<span style="font-weight: bold">==</span><span style="color: #009999">1</span>:
        inpfil<span style="font-weight: bold">=</span><span style="color: #bb8844">&#39;temp.py&#39;</span> <span style="color: #999988; font-style: italic">#default input file</span>
        <span style="font-weight: bold">print</span>(<span style="color: #bb8844">&#39;default file temp.py with content:&#39;</span>)
        rf <span style="font-weight: bold">=</span> <span style="color: #999999">open</span>(inpfil, <span style="color: #bb8844">&#39;r&#39;</span>)
        <span style="font-weight: bold">with</span> rf:
            demo_code<span style="font-weight: bold">=</span>rf<span style="font-weight: bold">.</span>read()
        <span style="font-weight: bold">print</span>(demo_code)
        outfil <span style="font-weight: bold">=</span> <span style="color: #999999">input</span>(<span style="color: #bb8844">&#39;\nEnter the Output file name(!! Previous Data will be overwritten !!):&#39;</span>)
        obj <span style="font-weight: bold">=</span> plain_text_to_formatted_text(inpfil, outfil<span style="font-weight: bold">+</span><span style="color: #bb8844">&#39;.html&#39;</span>)
        Code <span style="font-weight: bold">=</span> obj<span style="font-weight: bold">.</span>file_()
        Var <span style="font-weight: bold">=</span> obj<span style="font-weight: bold">.</span>line_numbers()
        Styl <span style="font-weight: bold">=</span> obj<span style="font-weight: bold">.</span>select_style()
        obj<span style="font-weight: bold">.</span>_plain_text_to_formatted_text__conversion(Code, Var, Styl) <span style="color: #999988; font-style: italic">#Private method call will require class name</span>

    <span style="font-weight: bold">elif</span> ch<span style="font-weight: bold">==</span><span style="color: #009999">2</span>:
        inpfil <span style="font-weight: bold">=</span> <span style="color: #999999">input</span>(<span style="color: #bb8844">&#39;Enter the Input file name:&#39;</span>)
        outfil <span style="font-weight: bold">=</span> <span style="color: #999999">input</span>(<span style="color: #bb8844">&#39;Enter the Output file name(!! Previous Data will be overwritten !!):&#39;</span>)
        obj <span style="font-weight: bold">=</span> plain_text_to_formatted_text(inpfil,outfil<span style="font-weight: bold">+</span><span style="color: #bb8844">&#39;.html&#39;</span>)
        Code <span style="font-weight: bold">=</span> obj<span style="font-weight: bold">.</span>file_()
        Var <span style="font-weight: bold">=</span> obj<span style="font-weight: bold">.</span>line_numbers()
        Styl <span style="font-weight: bold">=</span> obj<span style="font-weight: bold">.</span>select_style()
        obj<span style="font-weight: bold">.</span>_plain_text_to_formatted_text__conversion(Code,Var,Styl) <span style="color: #999988; font-style: italic">#Private method call will require class name</span>

    <span style="font-weight: bold">else</span>:
        <span style="color: #999999">exit</span>(<span style="color: #009999">0</span>)
</pre></div>
